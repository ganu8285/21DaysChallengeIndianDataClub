select * from patients;

SELECT
	P.PATIENT_ID,
	P.NAME,
	P.AGE,
	P.SERVICE,
	S.TOTAL_STAFF
FROM
	PATIENTS P
	JOIN (
		SELECT
			SERVICE,
			COUNT(*) AS TOTAL_STAFF
		FROM
			STAFF
		GROUP BY
			SERVICE
		HAVING
			COUNT(*) > 5
	) S ON P.SERVICE = S.SERVICE
ORDER BY
	S.TOTAL_STAFF DESC,
	P.NAME DESC;
 